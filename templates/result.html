<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>뉴스 워드클라우드</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/wordcloud2.js/1.1.0/wordcloud2.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <h1>뉴스 워드클라우드</h1>
    <canvas id="barChart"></canvas>
    <script>
        // HTML 문서에서 'barChart' 요소 가져오기
        const ctx = document.getElementById("barChart");
        // Chart.js 객체 생성
        new Chart(ctx, {
            type: "bar",   // 차트 유형: 'bar' = 막대그래프
            data: {
                // Flask에서 전달된 단어 목록 (labels) → JSON 형식으로 변환
                labels: {{ labels|tojson }},
                datasets: [{
                    label: "단어 빈도수",             // 범례(Label)
                    data: {{ values|tojson }},         // 각 단어의 빈도 값
                    backgroundColor: "rgba(54, 162, 235, 0.6)",  // 막대 내부 색상
                    borderColor: "rgba(54, 162, 235, 1)",        // 막대 테두리 색상
                    borderWidth: 1                                 // 테두리 두께
                }]
            },
            options: {
                responsive: true,    // 반응형 (화면 크기에 따라 자동 조정)
                plugins: {
                    title: {
                        display: true,                // 제목 표시 여부
                        text: "텍스트 마이닝 단어 빈도 분석"  // 그래프 제목
                    }
                },
                scales: {
                    y: { beginAtZero: true }          // Y축을 0부터 시작
                }
            }
        });
    </script>

    <!--워드클라우드 (WordCloud.js) -->
    <h2>워드클라우드 (WordCloud.js)</h2>
    <!-- 워드클라우드가 표시될 캔버스 -->
    <canvas id="wordCanvas" width="800" height="400"></canvas>

    <script>
        // Flask에서 전달된 워드클라우드용 데이터 (JSON)
        // 예: [{"text": "경제", "weight": 25}, {"text": "성장", "weight": 18}, ...]
        const words = {{ wc_data|tojson }};

        // WordCloud.js는 [[단어, 빈도]] 형태의 2차원 배열을 요구함
        // 따라서 변환 작업 수행
        const list = words.map(item => [item.text, item.weight]);

        // 워드클라우드 생성
        WordCloud(document.getElementById('wordCanvas'), {
            list: list,                  // 단어 목록 (예: [["경제", 25], ["성장", 18], ...])
            gridSize: 10,                // 단어 간격 (값이 작을수록 촘촘함)
            weightFactor: 15,            // 빈도수에 따른 글자 크기 비율
            fontFamily: 'Malgun Gothic, sans-serif',  // 폰트 (한글 지원 필수)
            color: 'random-dark',        // 단어 색상 (랜덤 다크 톤)
            backgroundColor: 'white',    // 배경색
            rotateRatio: 0.2,            // 단어 회전 비율 (20% 정도 회전)
            rotationSteps: 2,            // 회전 각도 단계 (예: 0°, 90°)
            drawOutOfBound: false        // 캔버스 영역 밖 단어 그리지 않음
        });
    </script>
</body>
</html>